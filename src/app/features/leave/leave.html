<div class="leave-container">

  <!-- Header -->
  <div class="page-header">
    <h2>مدیریت مرخصی‌ها</h2>
    <button class="btn-primary" (click)="openModal()">➕ درخواست جدید</button>
  </div>

  <!-- Info Cards -->
  <div class="stats-cards">

    <div class="card">
      <div class="title">مرخصی کل</div>
      <div class="value">{{ leaveInfo.total }}</div>
    </div>

    <div class="card">
      <div class="title">مصرف شده</div>
      <div class="value">{{ leaveInfo.used }}</div>
    </div>

    <div class="card highlight">
      <div class="title">باقی‌مانده</div>
      <div class="value">{{ leaveInfo.remaining }}</div>
    </div>

  </div>

  <!-- Last Request -->
  <div class="last-request">

    <h3>آخرین درخواست</h3>

    <div class="request-box">
      <p><strong>نوع:</strong> {{ leaveInfo.lastRequest.type }}</p>
      <p><strong>تاریخ:</strong> {{ leaveInfo.lastRequest.date }}</p>
      <p>
        <strong>وضعیت:</strong>
        <span class="badge" [ngClass]="leaveInfo.lastRequest.status">
          {{ leaveInfo.lastRequest.status | statusName }}
        </span>
      </p>
    </div>

  </div>

  <!-- Table -->
  <div class="table-box">
    <h3>سوابق درخواست‌ها</h3>

    <table>
      <thead>
        <tr>
          <th>نوع مرخصی</th>
          <th>از</th>
          <th>تا</th>
          <th>روز</th>
          <th>توضیح</th>
          <th>وضعیت</th>
        </tr>
      </thead>

      <tbody>
        <tr *ngFor="let item of leaves">
          <td>{{ item.type }}</td>
          <td>{{ item.start }}</td>
          <td>{{ item.end }}</td>
          <td>{{ item.days }}</td>
          <td>{{ item.desc || '-' }}</td>
          <td>
            <span class="badge" [ngClass]="item.status">
              {{ item.status | statusName }}
            </span>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Modal -->
  <div class="modal-backdrop" *ngIf="showModal" (click)="closeModal()"></div>

  <div class="modal" *ngIf="showModal">
    <h3>درخواست مرخصی جدید</h3>

    <div class="form-group">
      <label>نوع مرخصی</label>
      <select [(ngModel)]="newLeave.type">
        <option value="">انتخاب کنید...</option>
        <option>استحقاقی</option>
        <option>استعلاجی</option>
        <option>بدون حقوق</option>
      </select>
    </div>

    <div class="form-row">
      <div>
        <label>از تاریخ</label>
        <input type="date" [(ngModel)]="newLeave.start" (change)="calcDays()">
      </div>

      <div>
        <label>تا تاریخ</label>
        <input type="date" [(ngModel)]="newLeave.end" (change)="calcDays()">
      </div>
    </div>

    <div class="form-group">
      <label>توضیحات</label>
      <textarea rows="3" [(ngModel)]="newLeave.desc"></textarea>
    </div>

    <div class="days-box">
      <strong>تعداد روز:</strong>
      <span>{{ newLeave.days }}</span>
    </div>

    <div class="modal-actions">
      <button class="btn-primary" (click)="submitLeave()">ثبت</button>
      <button class="btn-secondary" (click)="closeModal()">لغو</button>
    </div>
  </div>

</div>
