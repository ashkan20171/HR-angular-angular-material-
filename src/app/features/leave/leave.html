<div class="leave-page">

  <h1>๐ ูุฏุฑุช ูุฑุฎุต</h1>

  <!-- ุจุฎุด ุงุทูุงุนุงุช ฺฉุงุฑุจุฑ -->
  <div class="info-grid">

    <div class="info-card">
      <h3>ุฑูุฒูุง ุจุงููุงูุฏู</h3>
      <p class="value green">{{ leaveInfo.remaining }}</p>
      <div class="progress">
        <div class="bar" [style.width.%]="(leaveInfo.used / leaveInfo.total) * 100"></div>
      </div>
    </div>

    <div class="info-card">
      <h3>ุฑูุฒูุง ุงุณุชูุงุฏูโุดุฏู</h3>
      <p class="value blue">{{ leaveInfo.used }}</p>
    </div>

    <div class="info-card">
      <h3>ฺฉู ุณููู ุณุงู</h3>
      <p class="value">{{ leaveInfo.total }}</p>
    </div>

    <div class="info-card last">
      <h3>ุขุฎุฑู ูุฑุฎุต ุซุจุชโุดุฏู</h3>
      <p>{{ leaveInfo.lastRequest.type }}</p>
      <span class="status" [ngClass]="leaveInfo.lastRequest.status">
        {{ leaveInfo.lastRequest.status === 'accepted' ? 'ุชุงุฏ ุดุฏู'
        : leaveInfo.lastRequest.status === 'rejected' ? 'ุฑุฏ ุดุฏู'
        : 'ุฏุฑ ุงูุชุธุงุฑ' }}
      </span>
    </div>

  </div>

  <!-- ูููุฏุงุฑ -->
  <div class="chart-box">
    <img src="/assets/charts/chart-leave.png" alt="Leave chart">
  </div>

  <!-- ุจุฎุด ุฌุฏูู -->
  <div class="table-header">
    <h2>ุณูุงุจู ูุฑุฎุต</h2>
    <button class="btn-new" (click)="openModal()">โ ุซุจุช ุฏุฑุฎูุงุณุช ุฌุฏุฏ</button>
  </div>

  <table class="leave-table">
    <thead>
      <tr>
        <th>ููุน</th>
        <th>ุงุฒ ุชุงุฑุฎ</th>
        <th>ุชุง ุชุงุฑุฎ</th>
        <th>ุฑูุฒ</th>
        <th>ูุถุนุช</th>
        <th>ุชูุถุญุงุช</th>
      </tr>
    </thead>

    <tbody>
      <tr *ngFor="let l of leaves">
        <td>{{ l.type }}</td>
        <td>{{ l.start }}</td>
        <td>{{ l.end }}</td>
        <td>{{ l.days }}</td>
        <td>
          <span class="status" [ngClass]="l.status">
            {{ l.status === 'pending' ? 'ุฏุฑ ุงูุชุธุงุฑ'
            : l.status === 'accepted' ? 'ุชุงุฏ ุดุฏู'
            : 'ุฑุฏ ุดุฏู' }}
          </span>
        </td>
        <td>{{ l.desc || '-' }}</td>
      </tr>
    </tbody>
  </table>

  <!-- Modal ูุฑู -->
  <div class="modal" *ngIf="showModal">
    <div class="modal-box">

      <h2>ุซุจุช ุฏุฑุฎูุงุณุช ูุฑุฎุต</h2>

      <label>ููุน ูุฑุฎุต</label>
      <select [(ngModel)]="newLeave.type">
        <option value="">ุงูุชุฎุงุจ ฺฉูุฏ</option>
        <option>ุงุณุชุญูุงู</option>
        <option>ุงุณุชุนูุงุฌ</option>
        <option>ุจุฏูู ุญููู</option>
      </select>

      <label>ุงุฒ ุชุงุฑุฎ</label>
      <input type="date" [(ngModel)]="newLeave.start" (change)="calcDays()">

      <label>ุชุง ุชุงุฑุฎ</label>
      <input type="date" [(ngModel)]="newLeave.end" (change)="calcDays()">

      <label>ุชูุถุญุงุช</label>
      <textarea [(ngModel)]="newLeave.desc"></textarea>

      <p class="days-preview">
        ุชุนุฏุงุฏ ุฑูุฒ: <strong>{{ newLeave.days }}</strong>
      </p>

      <div class="modal-actions">
        <button class="cancel" (click)="closeModal()">ุงูุตุฑุงู</button>
        <button class="submit" (click)="submitLeave()">ุซุจุช ุฏุฑุฎูุงุณุช</button>
      </div>

    </div>
  </div>

</div>
